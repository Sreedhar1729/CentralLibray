sap.ui.define(["sap/ui/core/mvc/Controller"],function(e){"use strict";return e.extend("com.app.centrallibrary.controller.UserLoans",{onInit:function(){var e=this.byId("idUserLoans");var s=e.getColumns()[6];s.setVisible(false)},onClickDelete:async function(e){var s=this.byId("idUserLoans").getSelectedItem().getBindingContext().getObject();console.log(s);if(typeof s.books.avl_stock==="number"){s.books.avl_stock=Math.max(0,s.books.avl_stock+1);var o=this.getView().getModel("ModelV2");try{await o.update("/Books("+s.books.ID+")",s.books)}catch(e){console.error("Error updating book avl_stock:",e)}}else{console.error("Quantity is not a number.")}const t=new sap.ui.model.json.JSONModel({ID:s.ID,books_ID:s.books.ID,users_ID:s.users.ID,Active:false});this.getView().setModel(t,"newUserLoans");const a=this.getView().getModel("newUserLoans").getData();o=this.getView().getModel("ModelV2");try{o.update("/BooksLoan("+a.ID+")",a,{success:function(){this.getView().byId("idUserLoans").getBinding("items").refresh();sap.m.MessageBox.success("Loan closed Successfully!!!")}.bind(this),error:function(e){sap.m.MessageBox.error("Failed to update book: "+e.message)}.bind(this)})}catch(e){sap.m.MessageBox.error("Some technical Issue")}var o=new sap.ui.model.odata.v2.ODataModel({serviceUrl:"https://port4004-workspaces-ws-ljsm6.us10.trial.applicationstudio.cloud.sap/v2/BookSRV",defaultBindingMode:sap.ui.model.BindingMode.TwoWay,messageParser:sap.ui.model.odata.ODataMessageParser})}})});