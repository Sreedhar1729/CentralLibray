sap.ui.define(["sap/ui/core/mvc/Controller"],function(e){"use strict";return e.extend("com.app.centrallibrary.controller.UserLoans",{onInit:function(){var e=this.byId("idUserLoans");var s=e.getColumns()[6];s.setVisible(false)},onClickDelete:async function(e){var s=this.byId("idUserLoans").getSelectedItems();if(s.length>1){sap.m.MessageBox.error("Dont select Multiple Entries for Closing Loan")}else if(s.length==0){sap.m.MessageBox.error(`Please Select atleast One ROW for Closing Loan`)}else{var o=this.byId("idUserLoans").getSelectedItem().getBindingContext().getObject();console.log(o);if(typeof o.books.avl_stock==="number"){o.books.avl_stock=Math.max(0,o.books.avl_stock+1);var t=this.getView().getModel("ModelV2");try{await t.update("/Books("+o.books.ID+")",o.books)}catch(e){console.error("Error updating book avl_stock:",e)}}else{console.error("Quantity is not a number.")}const e=new sap.ui.model.json.JSONModel({ID:o.ID,books_ID:o.books.ID,users_ID:o.users.ID,Active:false});this.getView().setModel(e,"newUserLoans");const s=this.getView().getModel("newUserLoans").getData();t=this.getView().getModel("ModelV2");try{t.update("/BooksLoan("+s.ID+")",s,{success:function(){this.getView().byId("idUserLoans").getBinding("items").refresh();sap.m.MessageBox.success(`${s.users_ID}  Loan closed Successfully!!!`)}.bind(this),error:function(e){sap.m.MessageBox.error("Failed to update book: "+e.message)}.bind(this)})}catch(e){sap.m.MessageBox.error("Some technical Issue")}var t=new sap.ui.model.odata.v2.ODataModel({serviceUrl:"https://port4004-workspaces-ws-ljsm6.us10.trial.applicationstudio.cloud.sap/v2/BookSRV",defaultBindingMode:sap.ui.model.BindingMode.TwoWay,messageParser:sap.ui.model.odata.ODataMessageParser})}}})});